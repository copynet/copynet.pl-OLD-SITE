<?php /*=============================| Set Display Preferences |====================================*/$lewaStrona ='';$NumMonthsToDisplay = 1; // total months displayed on page$DayWeekStarts = 2;       // 1=sun,2=mon,3=tue,4=wed,5=thur,6=fri,7=sat$NumMonthsPerRow = 3;     // how many months (columns) are displayed horizontally/*==========================================================================================*///populate MonthNames & DayNames array for display purposes$MonthNames = array(1=>'Styczeń','Luty','Marzec','Kwiecień','Maj','Czerwiec','Lipiec','Sierpień','Wrzesień','Październik','Listopad','Grudzień');$DayNames = array(1=>'Ndz','Pon','Wt','Śr','Cz','Pt','Sob');$CurDate = getdate();//Initialize Page Variables$CurrentYear = $CurDate['year'];$CurrentMonth = $CurDate['mon'];########################if(!isset($_POST['pokaz'])){	$aktualny_mc = $miesiac = $CurrentMonth;}else{	$aktualny_mc = $_POST['pokaz'];	if($POST['pokaz']>12){		$pokaz = $_POST['pokaz']-1;		$rok = floor($pokaz/12);		$CurrentYear += $rok;		$miesiac = $pokaz-($rok*12)+1;	}else{		$miesiac = $_POST['pokaz'];	}}$MonthLoop = $miesiac;#######################$YearLoop = $CurrentYear;$MonthsPerRowCounter = 1;$NumRowsInMainTable = $NumMonthsToDisplay/3;//begin table display, 3 months per row//$lewaStrona .=  '<table width="90%">';for ($j=1; $j<=$NumMonthsToDisplay; $j++) {	// Main loop, 1 iteration for each Month //====================================================================================//figure out when to start a new rowif($MonthsPerRowCounter == 0){$beginnewline=1;} else {$beginnewline=0;}if($MonthsPerRowCounter == $NumMonthsPerRow){$endline=1;} else {$endline=0;}if ($beginnewline == 1){$lewaStrona .=  "<tr>";}//compute number of days in this Month/Year iteration$NumberOfDays = date(t,mktime(0,0,0,$MonthLoop+1,0,$YearLoop,-1));//compute 1st Day of the week for 1st day of the Month$FirstDayOfWeek = date(l,mktime(0,0,0,$MonthLoop,1,$YearLoop));//compute number of days to offset 1st day of Monthswitch ($FirstDayOfWeek) {  	case 'Monday':		$DayOfWeekNum = 2; 		switch ($DayWeekStarts) {			case '1': $offset=1; break;			case '2': $offset=0; break;			case '3': $offset=6; break;			case '4': $offset=5; break;			case '5': $offset=4; break;			case '6': $offset=3; break;			case '7': $offset=2; break;		}	break;	case 'Tuesday': 		$DayOfWeekNum = 3;  		switch ($DayWeekStarts) {			case '1': $offset=2; break;			case '2': $offset=1; break;			case '3': $offset=0; break;			case '4': $offset=6; break;			case '5': $offset=5; break;			case '6': $offset=4; break;			case '7': $offset=3; break;		}	break;	case 'Wednesday':		$DayOfWeekNum = 4;   		switch ($DayWeekStarts) {			case '1': $offset=3; break;			case '2': $offset=2; break;			case '3': $offset=1; break;			case '4': $offset=0; break;			case '5': $offset=6; break;			case '6': $offset=5; break;			case '7': $offset=4; break;		}	break;	case 'Thursday': 		$DayOfWeekNum = 5;		switch ($DayWeekStarts) {			case '1': $offset=4; break;			case '2': $offset=3; break;			case '3': $offset=2; break;			case '4': $offset=1; break;			case '5': $offset=0; break;			case '6': $offset=6; break;			case '7': $offset=5; break;		}	break;	case 'Friday':  		$DayOfWeekNum = 6;		switch ($DayWeekStarts) {			case '1': $offset=5; break;			case '2': $offset=4; break;			case '3': $offset=3; break;			case '4': $offset=2; break;			case '5': $offset=1; break;			case '6': $offset=0; break;			case '7': $offset=6; break;		}	break;	case 'Saturday':		$DayOfWeekNum = 7;  		switch ($DayWeekStarts) {			case '1': $offset=6; break;			case '2': $offset=5; break;			case '3': $offset=4; break;			case '4': $offset=3; break;			case '5': $offset=2; break;			case '6': $offset=1; break;			case '7': $offset=0; break;		}	break;		default: 		$DayOfWeekNum = 1;		switch ($DayWeekStarts) {			case '1': $offset=0; break;			case '2': $offset=6; break;			case '3': $offset=5; break;			case '4': $offset=4; break;			case '5': $offset=3; break;			case '6': $offset=2; break;			case '7': $offset=1; break;		}}//$lewaStrona .=  '<td>	$lewaStrona .=  '<table width="100%" id="kalendarz" border=1px style="">		<tr class="miesiac">		<td colspan="7" align="center" valing=middle>			<form method="post" action="" style="float:left">				<input type="submit" name="wyslij" value=" <<< " />				<input type="hidden" name="pokaz" value="'.($aktualny_mc-1).'" />			</form>				<b>'.$MonthNames[$MonthLoop].'</b>				<form method="post" action="" style="float:right;">				<input type="submit" name="wyslij" value=" >>> " />				<input type="hidden" name="pokaz" value="'.($aktualny_mc+1).'" />			</form>		</td>	</tr>	<tr align="center">';//display Days of week, using $DayWeekStarts as 1st day$i=0;for ($i=1; $i<=7; $i++){	$thisDay = $i-1 + $DayWeekStarts;	if ($thisDay>7){$thisDay=$thisDay-7;}	$lewaStrona .= '<td class="dzien_tygodnia"><b>'.$DayNames[$thisDay].'</b></td>';}$lewaStrona .=  "</tr>\n";$lewaStrona .=  "<tr align=\"center\">\n";//print $offset blank table cells at beginning of monthif ($offset > 0) {	$lewaStrona .=  str_repeat("<td class=\"pusta\">&nbsp;</td>\n",$offset);}//print days of the month, Day1-$NumberOfDays$i=0;for ($i=1; $i <= $NumberOfDays; $i++) {	$DayOfWeek = date(l,mktime(0,0,0,$MonthLoop,$i,$YearLoop));		$dzienDoSprwadzenia = mktime(0,0,0,$MonthLoop,$i,$YearLoop);	//echo '<br />';		if($DayOfWeekNum == $DayWeekStarts) {		$lewaStrona .=  '<tr align="center">';	}	if(($i == $CurDate['mday']) && ($MonthLoop == $CurrentMonth) && ($YearLoop == $CurrentYear)){		$lewaStrona .=  '<td class="dzisiaj';		if($DayOfWeekNum == ($DayWeekStarts-1)) { $lewaStrona .= ' niedziela'; }		$lewaStrona .= '">'.$i.'</td>';	}else{		// sprwadzamy czy jest coś w bazie dla danej daty		print_r($_SESSION);		$select = "SELECT kalendarium.*, artykuly.id_artykulu, artykuly.tytul_artykulu, artykuly.id_kategorii FROM kalendarium, artykuly		WHERE kalendarium.data = '".$YearLoop.'-'.$MonthLoop.'-'.$i."'		AND kalendarium.id_artykulu = artykuly.id_artykulu";				$query = mysql_query($select) or die(mysql_error());				if(mysql_num_rows($query)>0){			$row = mysql_fetch_array($query);						$lewaStrona .=  '<td class="activ">			<a href="'.LANG.'kalendarium/'.$row['id_artykulu'].'-'.usun_znaki_specjalne($row['tytul_artykulu']).'.html" title="'.$row['tytul_artykulu'].'">'.$i.'</a></td>';		}else{					$lewaStrona .=  '<td';			if($DayOfWeekNum == ($DayWeekStarts-1)) { $lewaStrona .= ' class="niedziela"'; }			$lewaStrona .= '>'.$i.'</td>';		}	}	if($DayOfWeekNum == ($DayWeekStarts-1)) {		$lewaStrona .=  '</tr>';	}	if($DayOfWeekNum == 7){$DayOfWeekNum=1;} else{$DayOfWeekNum++;}}//print blank table cells at end of the monthif ( ( ($offset == 5) && ($NumberOfDays > 30) ) || ( ($offset == 6) && ($NumberOfDays > 29) ) ) {	if (42-$NumberOfDays-$offset > 0) {		$lewaStrona .=  str_repeat("<td class=\"pusta\">&nbsp;</td>\n",42-$NumberOfDays-$offset);	}	$lewaStrona .=  "</tr>\n";} elseif ( ($NumberOfDays != 28) || ($offset > 0) ) {	if (35-$NumberOfDays-$offset > 0) {		$lewaStrona .=  str_repeat("<td class=\"pusta\">&nbsp;</td>\n",35-$NumberOfDays-$offset);	$lewaStrona .=  "</tr>\n";	}}//end calendar table display$lewaStrona .= '</table><br /></td>';//increase Month count each time through the loop, reset to Jan if this iteration is Decif ($MonthLoop == 12){$MonthLoop = 1; $YearLoop++;} else{$MonthLoop++;}if ($MonthsPerRowCounter == $NumMonthsPerRow) {$MonthsPerRowCounter = 1;} else{$MonthsPerRowCounter++;}if ($endline == 1){$lewaStrona .= '</tr><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>';}//====================================================================================}//end HTML page display//$lewaStrona .=  '</td></tr></table>';//////////// wyswietl formularz ///////////////////////////?>